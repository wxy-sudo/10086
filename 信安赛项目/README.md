# 基于格的多关键字模糊可搜索加密

## 实现思路

随着当下云存储技术的不断发展, 越来越多的用户选择将隐私数据存储至云服务器, 结合可搜索加密技术, 用户能够随时随地检索密文数据。考虑到云端存储的密文数据总量 在持续增长, 而目前的公钥可搜索加密方案大多是基于双线性对构建的, 其计算开销大, 过长的检索耗时将会影响用户体验。与此同时, 随着量子计算机研制技术的不断突破, 攻击者可以利用量子计算机攻破目前大多数 PEKS 安全体制, 从而窃取用户的隐私数据。
由此可见, 传统 PEKS 方案面临着通讯及时性和密文安全性的双重考验, 因而, 构建 出安全高效的公钥可搜索加密方案已成为当前密码学领域的研究热点。

为了在云环境下 安全高效地检索密文数据, 本文首先基于容错学习 (Learning with Error,LWE) 的环变体和小整数解问题 (Small Integer Solutions,SIS) 的环变体, 构造了格上安全的公钥可搜索加密 (Public-key Encryption with Conjunctive Keyword Search,PEKS) 方案, 随后给出了此方案的 计算一致性及 IND-CPA-secure 安全性证明。我们使用基于 Ring-SIS/LWE 困难性的 IBE 来构建 PEKS, 相比基于双线性对构建的 PECKS 方案, 本文提出的方案能够抵抗量子 计算机攻击, 并且能保证更高的检索效率。

同时, 我们创新性地提出了一种面向多关键字的生成安全索引的方案。该方案实施的 基础为布隆过滤器, 随后利用对偶编码函数以及位置敏感 Hash 函数 (LSH) 构建文件对应 的文件索引, 在生成安全索引后使用距离可恢复加密算法对该安全索引进行加密操作, 从 而实现了针对于多关键字的密文模糊搜索。除此之外, 此方案不需要提前为安全索引创建 存储空间, 因此该搜索方案的复杂度得到了很大程度上的降低。并且, 该面向多关键字的 模糊密文搜索方案与现有方案相比较不需要提前定义字典库, 从而减小了存储上锁花费 的开销。

最后在本文中, 我们对该模糊搜索方案进行了安全性分析, 证明该方案不仅能够实现面向多关键字的密文模糊搜索, 而且保证了方案的机密性、隐私性和完整性。
在生成安全索引后, 我们将上述生成安全索引方案与基于格的 PEKS 方案相关联, 提出基于格的面向多关键字的模糊密文搜索方案。将安全索引作为 “邮递员”, 经过哈希变换后压缩为基于格的 PEKS 方案中的输人 id 。由于上述方案全部在文件搜索前便可完成, 即在发送时便进行上述操作。而搜索过程在接收方空闲时选择接收时才会按照用户需求 进行, 保证了各过程的独立性。最终我们将我们的方案与现有的 PEKS 方案进行了效率对 比。结果显示, 我们的实现具有很好的效率。并且, 当安全参数提高时, 整体运行的时间 几乎只是成比例地增长, 而不会带来额外的性能浪费, 具有较高的扩展性。

## 空间效率对比分析

为了做进一步评估，我们将本文中的实现与一些其它的PEKS方案进行了效率对比。我们分别对于四种不同的方案在同一环境下进行了测试，分别为：

    BOYa--Behnia等人使用了NTRU格的PEKS算法，空间需求较小
    
    BOYb--Behnia等人使用了NTRU格的PEKS算法，空间需求较小
    
    ZXW--Zhang,X.基于IIOT技术使用了LWE问题的PEKS算法，基于身份加密
    
    LTT——Liu,Z.Y.使用了LWE问题的公钥认证加密算法，具备抗量子能力以及更高的安全性


在对应方案的默认安全参数下，得到的空间储存需求对比见下图：

![Image text](https://github.com/wxy-sudo/wxy-s/blob/main/%E5%88%9B%E6%96%B0%E5%88%9B%E4%B8%9A%E5%9B%BE%E7%89%87/%E4%BF%A1%E5%AE%89%E8%B5%9B/%E7%A9%BA%E9%97%B4%E5%AF%B9%E6%AF%94.png)

BOYa方案有一个主要的存储优势，它基于NTRU，需要很小的存储开销。与我们的方案相比，我们的方案具有更小的私钥大小。与基于LWE的方案相比，我们的方案在公钥、私钥和密文存储方面具有更显著的优势。

## 时间效率对比

### Trapdoor时间对比

![Image text](https://github.com/wxy-sudo/wxy-s/blob/main/%E5%88%9B%E6%96%B0%E5%88%9B%E4%B8%9A%E5%9B%BE%E7%89%87/%E4%BF%A1%E5%AE%89%E8%B5%9B/Trapdoor%E6%97%B6%E9%97%B4%E5%AF%B9%E6%AF%94.png)

### PEKS时间对比

![Image text](https://github.com/wxy-sudo/wxy-s/blob/main/%E5%88%9B%E6%96%B0%E5%88%9B%E4%B8%9A%E5%9B%BE%E7%89%87/%E4%BF%A1%E5%AE%89%E8%B5%9B/PEKS%E6%97%B6%E9%97%B4%E5%AF%B9%E6%AF%94.png)

### Test时间对比

![Image text](https://github.com/wxy-sudo/wxy-s/blob/main/%E5%88%9B%E6%96%B0%E5%88%9B%E4%B8%9A%E5%9B%BE%E7%89%87/%E4%BF%A1%E5%AE%89%E8%B5%9B/Test%E6%97%B6%E9%97%B4%E5%AF%B9%E6%AF%94.png)

我们注意到，对于加密算法的计时，我们的计时比BOYa长。但是，对于每个搜索查询，Test算法对每个关键字及文件对执行一次。并且我们可以注意到，该方案在实际应用中最重要的是Test测试算法的效率，用户最在意的就是关键词集合查询时所消耗的时间。因此，测试算法的效率尤为重要，这导致了计算开销。请注意，测试时间取决于安全参数、关键字的平均长度和硬件条件。在我们的环境中，如果安全参数为80，那么我们的PEKS方案的平均测试时间为0.19ms;如果安全参数为192位，则我们的PEKS方案的平均测试时间为0.97ms。对于80位的安全性，Test算法的效率比BOYa提高了约2倍，在端到端延迟方面具有优势，适合后期进行商用的推进。
